deal with the boundary case seperately, if required, like you did in peak finding